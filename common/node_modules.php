<?php

namespace Deployer;

task('deploy:cleanup:node',  function () {

    if (!test('[ -d {{deploy_path}}/current/node_modules ]')) {
        return;
    }

    $sudo = get('cleanup_use_sudo') ? 'sudo' : '';
    run("$sudo rm -rf {{deploy_path}}/current/node_modules");
});


task('deploy:previous_release:cleanup_node',  function () {
    if (!has('previous_release')) {
        return;
    }
    if (!test('[ -d {{previous_release}}/node_modules ]')) {
        return;
    }

    $sudo = get('cleanup_use_sudo') ? 'sudo' : '';
    run("$sudo rm -rf {{previous_release}}/node_modules");
});
